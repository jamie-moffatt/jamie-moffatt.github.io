<!doctype html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Advanced Options for Trials | Jamie Moffatt</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Advanced Options for Trials" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Jamie is a psychology PhD student based at the University of Sussex." />
<meta property="og:description" content="Jamie is a psychology PhD student based at the University of Sussex." />
<link rel="canonical" href="http://localhost:4000/assets/jsPsych-master-6.1/docs/overview/trial.html" />
<meta property="og:url" content="http://localhost:4000/assets/jsPsych-master-6.1/docs/overview/trial.html" />
<meta property="og:site_name" content="Jamie Moffatt" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Advanced Options for Trials" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"Advanced Options for Trials","description":"Jamie is a psychology PhD student based at the University of Sussex.","url":"http://localhost:4000/assets/jsPsych-master-6.1/docs/overview/trial.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/assets/css/style.css?v=">
  <link rel="stylesheet" href="assets/css/social-circles.min.css"> <!-- Social media buttons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> <!-- icons -->
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
  <script src="/assets/js/respond.js"></script>
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <!--[if lt IE 8]>
  <link rel="stylesheet" href="/assets/css/ie.css">
  <![endif]-->
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  <script>
  function verticalNav() {
    var x = document.getElementById("mytopnav");
    if (x.className === "topnav") {
      x.className += " responsive";
    } else {
      x.className = "topnav";
    }
  }
</script>



</head>
<body>
  <div id="header">
    <nav id = "mytopnav" class = "topnav">
      <li class = "active"><a href = 'https://jamie-moffatt.github.io'>Home</a></li>
      <li><a href = "/publications">Publications</a></li>
      <li><a href = "/jspsych">jsPsych Tutorials</a></li>
      <li><a href="">View On GitHub</a></li>
      <li class="icon"><a href="javascript:void(0);" onclick="verticalNav()"><i class="fa fa-bars"></i></a></li>
      
    </nav>
  </div><!-- end header -->

  <div class="wrapper">

    <section>
      <div id="title">
        <div id = "title-container">
        <div id="title-text">
        <h1>Jamie Moffatt</h1>
        <p>Jamie is a psychology PhD student based at the University of Sussex.</p>
      </div>
      <div id = "title-img">
        <img src="/assets/img/test_profile.jpg" class = "profile">
      </div>
    </div>
        <hr>
        <span class="credits left">Project maintained by <a href=""></a></span>
        <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/mattgraham">mattgraham</a></span>
      </div>
      

      <h1 id="advanced-options-for-trials">Advanced Options for Trials</h1>

<p>The parameters available for a trial depend primarily on what plugin is used for the trial. However, there are several options that do not depend on the particular plugin; they are available for all trials.</p>

<h2 id="the-data-parameter">The data parameter</h2>

<p>The <code class="language-plaintext highlighter-rouge">data</code> parameter enables tagging the trial with additional properties. This can be useful for storing properties of the trial that are not directly apparent from the values that the plugin records. The <code class="language-plaintext highlighter-rouge">data</code> parameter value should be an object that contains key-value pairs.</p>

<p>A simple example is the <a href="https://en.wikipedia.org/wiki/Eriksen_flanker_task">Flanker Task</a>. In this experiment, participants respond to the direction of an arrow, pressing a key to the left for a left-pointing arrow (&lt;) and a key to the right for a right-pointing arrow (&gt;). The arrow appears in the center of <em>flankers</em>, or arrows that the participant should ignore. Those flankers can be congruent (»»&gt;) or incongruent («&gt;«).</p>

<p>A trial for the Flanker Task written with jsPsych might look like this:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">trial</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">html-keyboard-response</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">stimulus</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&lt;&lt;&lt;&lt;&lt;</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">choices</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">f</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">j</span><span class="dl">'</span><span class="p">],</span>
  <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">stimulus_type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">congruent</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">target_direction</span><span class="p">:</span> <span class="dl">'</span><span class="s1">left</span><span class="dl">'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Note the use of the data parameter to add a property <code class="language-plaintext highlighter-rouge">stimulus_type</code> with the value <code class="language-plaintext highlighter-rouge">congruent</code> and a property <code class="language-plaintext highlighter-rouge">target_direction</code> with the value <code class="language-plaintext highlighter-rouge">left</code>. Having these properties recorded directly in the data simplifies data analysis, making it easy to aggregate data by <code class="language-plaintext highlighter-rouge">stimulus_type</code> and/or <code class="language-plaintext highlighter-rouge">target_direction</code>.</p>

<h2 id="inter-trial-interval">Inter-trial interval</h2>

<p>The default inter-trial interval (ITI) in jsPsych is 0 ms. This can be adjusted at the experiment-wide level by changing the <code class="language-plaintext highlighter-rouge">default_iti</code> parameter in <code class="language-plaintext highlighter-rouge">jsPsych.init()</code>.</p>

<p>The ITI can also be controlled at the trial level through the <code class="language-plaintext highlighter-rouge">post_trial_gap</code> parameter. Setting this parameter to a positive integer <em>x</em> will cause a blank screen to display after the trial for <em>x</em> milliseconds.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">trial</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">html-keyboard-response</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">stimulus</span><span class="p">:</span> <span class="dl">'</span><span class="s1">There will be a 1.5 second blank screen after this trial.</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">post_trial_gap</span><span class="p">:</span> <span class="mi">1500</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="the-on_start-event">The on_start event</h2>

<p>Immediately before a trial runs, there is an opportunity to run an arbitrary function through the <code class="language-plaintext highlighter-rouge">on_start</code> event handler. This event handler is passed a single argument containing an <em>editable</em> copy of the trial parameters. This event handler can therefore be used to alter the trial based on the state of the experiment, among other uses.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">trial</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">html-keyboard-response</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">stimulus</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&lt;&lt;&lt;&lt;&lt;</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">choices</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">f</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">j</span><span class="dl">'</span><span class="p">],</span>
  <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">stimulus_type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">congruent</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">target_direction</span><span class="p">:</span> <span class="dl">'</span><span class="s1">left</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="na">on_start</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">trial</span><span class="p">){</span>
    <span class="nx">trial</span><span class="p">.</span><span class="nx">stimulus</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">&lt;&lt;&gt;&lt;&lt;</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">trial</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">stimulus_type</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">incongruent</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="the-on_finish-event">The on_finish event</h2>

<p>After a trial is completed, there is an opportunity to run an arbitrary function through the <code class="language-plaintext highlighter-rouge">on_finish</code> event handler. This event handler is passed a single argument containing an <em>editable</em> copy of the data recorded for that trial. This event handler can therefore be used to update the state of the experiment based on the data collected or modify the data collected.</p>

<p>This can be useful to calculate new data properties that were unknowable at the start of the trial. For example, with the Flanker Task example above, the <code class="language-plaintext highlighter-rouge">on_finish</code> event could add a new property <code class="language-plaintext highlighter-rouge">correct</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">trial</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">html-keyboard-response</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">stimulus</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&lt;&lt;&lt;&lt;&lt;</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">choices</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">f</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">j</span><span class="dl">'</span><span class="p">],</span>
  <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">stimulus_type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">congruent</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">target_direction</span><span class="p">:</span> <span class="dl">'</span><span class="s1">left</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="na">on_finish</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">key_press</span> <span class="o">==</span> <span class="mi">70</span><span class="p">){</span><span class="c1">// 70 is the numeric code for f</span>
      <span class="nx">data</span><span class="p">.</span><span class="nx">correct</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// can add property correct by modify data object directly</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">data</span><span class="p">.</span><span class="nx">correct</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="the-on_load-event">The on_load event</h2>

<p>The <code class="language-plaintext highlighter-rouge">on_load</code> callback can be added to any trial. The callback will trigger once the trial has completed loading. For most plugins, this will occur once the display has been initially updated but before any user interactions or timed events (e.g., animations) have occurred.</p>

<h4 id="sample-use">Sample use</h4>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">trial</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">image-keyboard-response</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">stimulus</span><span class="p">:</span> <span class="dl">'</span><span class="s1">imgA.png</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">on_load</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">The trial just finished loading.</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="dynamic-parameters">Dynamic parameters</h2>

<p>Most plugins allow parameters to be functions. In a typical declaration of a jsPsych trial, parameters have to be known at the start of the experiment. This makes it impossible to alter the content of the trial based on the outcome of previous trials. When functions are used as parameters for a block of trials, the function is evaluated at the start of each trial, and the return value of the function is used as the parameter. This enables dynamic updating of the parameter based on data that a subject has generated.</p>

<p>Here is a sketch of how this functionality could be used to display feedback to a subject in the Flanker Task.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">var</span> <span class="nx">timeline</span> <span class="o">=</span> <span class="p">[];</span>

<span class="kd">var</span> <span class="nx">trial</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">html-keyboard-response</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">stimulus</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&lt;&lt;&lt;&lt;&lt;</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">choices</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">f</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">j</span><span class="dl">'</span><span class="p">],</span>
  <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">stimulus_type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">congruent</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">target_direction</span><span class="p">:</span> <span class="dl">'</span><span class="s1">left</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="na">on_finish</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">key_press</span> <span class="o">==</span> <span class="mi">70</span><span class="p">){</span><span class="c1">// 70 is the numeric code for f</span>
      <span class="nx">data</span><span class="p">.</span><span class="nx">correct</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// can add property correct by modify data object directly</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">data</span><span class="p">.</span><span class="nx">correct</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">feedback</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">html-keyboard-response</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">stimulus</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">last_trial_correct</span> <span class="o">=</span> <span class="nx">jsPsych</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="kd">get</span><span class="p">().</span><span class="nx">last</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">correct</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">last_trial_correct</span><span class="p">){</span>
      <span class="k">return</span> <span class="dl">"</span><span class="s2">&lt;p&gt;Correct!&lt;/p&gt;</span><span class="dl">"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="dl">"</span><span class="s2">&lt;p&gt;Wrong.&lt;/p&gt;</span><span class="dl">"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">timeline</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">trial</span><span class="p">,</span> <span class="nx">feedback</span><span class="p">);</span>

</code></pre></div></div>


    </section>

  </div>

  
</body>
</html>
